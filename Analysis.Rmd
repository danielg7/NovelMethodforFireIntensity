---
title: "Analysis of Trial Data"
output:
  html_document:
    toc: true
    theme: united
    keep_md: true

---


Analysis of Trial Data for
======================================================
_A novel method for assessing fire temperature variability_
======================================================

Preliminary Work
----------

# Load Packages
```{r loadPackages, echo=TRUE, results='asis', warning=FALSE, include=TRUE, message=FALSE}
library(ggplot2)
library(lubridate)
library(jpeg)
library(png)
library(plyr)
library(reshape2)
library(gridExtra)
library(scales)
library(texreg)
library(ggthemes)
library(extrafont)

myTheme <- theme_tufte() +
  theme(
    text = element_text(family="sans",size=10),
    axis.line = element_line(size = .8)
  )
```
# Set Working Directory
This will need to be changed to wherever you save this.
```{r setWorkingDirector, echo=TRUE, results='hide', warning=FALSE}
setwd("/Users/danielgodwin/Dropbox/Graduate School/Dissertation/Chapter 1 - Fire Temperature/Calibration/NovelMethod_Data/")
```
# Data Files
Place these files into a folder called "Data/"

Raw iButton Data (Data/iButtons)
* day1_212.csv
* day1_b33_control.csv
* `day1_r23.csv`
* `day1_s02.csv`
* `day1_t3k.csv`
* `day1_t8f.csv`
* `day1_212.csv`
* `day2_b33_control.csv`
* `day2_r23.csv`
* `day2_so2.csv`
* `day2_t3k_.csv`
* `day2_t8f.csv`
* `day3_212_control.csv`
* `day3_220.csv`
* `day3_229K.csv`
* `day3_b33.csv`
* `day3_g16.csv`
* `day3_r23.csv`
* `day3_s02.csv`
* `day3_t3k.csv`
* `day3_t48.csv`
* `day3_t8f.csv`

Raw Thermocouple Data (Data/Thermocouple)
* `1-October_calibration.csv`
* `3-October_calibration.csv`

# Load ancillary functions

The scripts `read_temperature_functions.R` and `temperature_parsing.R` should be placed in a directory called "Scripts"

```{r sourceTempFxns, echo=TRUE, results='hide', warning=FALSE}
source(file = "Scripts/read_temperature_functions.R")
```

```{r sourceParsing, echo=TRUE, results='hide', warning=FALSE}
source(file = "Scripts/temperature_parsing.R")
```
# Use the above functions to load the data

The functions `read.hobo` and `read.ibutton` are useful tools for reading in iButton data and Hobo-brand thermocouple data.

```{r loadData, echo=TRUE, results='hide', warning=FALSE,cache.lazy=TRUE}


day1_212 <- read.ibutton("Data/iButtons/day1_212.csv")
day1_r23 <- read.ibutton("Data/iButtons/day1_r23.csv")
day1_s02 <- read.ibutton("Data/iButtons/day1_s02.csv")
day1_t8f <- read.ibutton("Data/iButtons/day1_t8f.csv")
day1_t3k <- read.ibutton("Data/iButtons/day1_t3k.csv")
day1_control <- read.ibutton("Data/iButtons/day1_b33_control.csv")

day2_212 <- read.ibutton("Data/iButtons/day2_212.csv")
day2_control <- read.ibutton("Data/iButtons/day2_b33_control.csv")
day2_r23 <- read.ibutton("Data/iButtons/day2_r23.csv")
day2_s02 <- read.ibutton("Data/iButtons/day2_s02.csv")
day2_t3k <- read.ibutton("Data/iButtons/day2_t3k.csv")
day2_t8f <- read.ibutton("Data/iButtons/day2_t8f.csv")

day3_control <- read.ibutton("Data/iButtons/day3_212_control.csv")
day3_220 <- read.ibutton("Data/iButtons/day3_220.csv")
day3_229k <- read.ibutton("Data/iButtons/day3_229K.csv")
day3_b33 <- read.ibutton("Data/iButtons/day3_b33.csv")
day3_g16 <- read.ibutton("Data/iButtons/day3_g16.csv")
day3_r23 <- read.ibutton("Data/iButtons/day3_r23.csv")
day3_s02 <- read.ibutton("Data/iButtons/day3_s02.csv")
day3_t3k <- read.ibutton("Data/iButtons/day3_t3k.csv")
day3_t48 <- read.ibutton("Data/iButtons/day3_t48.csv")
day3_t84 <- read.ibutton("Data/iButtons/day3_t84.csv")
day3_t8f <- read.ibutton("Data/iButtons/day3_t8f.csv")

day1_thermo <- na.omit(read.hobo(HoboFile = "Data/Thermocouple/1-October_calibration.csv"))
day3_thermo <- na.omit(read.hobo(HoboFile = "Data/Thermocouple/3-October_calibration.csv"))


calibrationData <- read.csv("Data/2014_calibration_data.csv",
                            na.strings="-9999"
                            )

```
# Parse the lookup table.

Lookup table dates and times have to be define.
```{r parseData,echo=TRUE, results='hide',warning=FALSE}
calibrationData$Date <- dmy(calibrationData$Date)
calibrationData$Time_Start_hms <- hms(calibrationData$Time_Start_hms)
calibrationData$Next_Time_Start_hms <- hms(calibrationData$Next_Time_Start_hms)
calibrationData$End_Time_Start_hms <- hms(calibrationData$End_Time_Start_hms)

calibrationData$FlameTime_seconds <- as.numeric(calibrationData$FlameTime_seconds)

calibrationData$Start_DateTime <- ymd_hms(paste(calibrationData$Date,calibrationData$Time_Start_hms))

calibrationData$End_DateTime <- ymd_hms(paste(calibrationData$Date,calibrationData$End_Time_Start_hms))

calibrationData$Next_Start_DateTime <- ymd_hms(paste(calibrationData$Date,calibrationData$Next_Time_Start_hms))



tz(calibrationData$Start_DateTime) <- "Africa/Johannesburg"
tz(calibrationData$End_DateTime) <- "Africa/Johannesburg"
tz(calibrationData$Next_Start_DateTime) <- "Africa/Johannesburg"

# Removed for saturation
calibrationData <- subset(calibrationData,Trial_Number != "12")
calibrationData <- subset(calibrationData,Trial_Number != "55")

# Removed for sensor error.
calibrationData <- subset(calibrationData,Trial_Number != "54")

```
# Merge the data by time to be able to compare the temperature methods
```{r mergeData, echo=TRUE, results='hide', warning=FALSE}
day1_212$iButton_Number <- "212"
day1_control$iButton_Number <- "B33"
day1_t3k$iButton_Number <- "T3K"
day1_t8f$iButton_Number <- "T8F"
day1_s02$iButton_Number <- "S02"
day1_r23$iButton_Number <- "R23"

day1_ibuttons <- rbind(day1_212,day1_control)
day1_ibuttons <- rbind(day1_ibuttons,day1_t3k)
day1_ibuttons <- rbind(day1_ibuttons,day1_t8f)
day1_ibuttons <- rbind(day1_ibuttons,day1_s02)
day1_ibuttons <- rbind(day1_ibuttons,day1_r23)


day1_ibuttons$Date <- dmy(1102014)

day2_212$iButton_Number <- "212"
day2_control$iButton_Number <- "B33"
day2_t3k$iButton_Number <- "T3K"
day2_t8f$iButton_Number <- "T8F"
day2_s02$iButton_Number <- "S02"
day2_r23$iButton_Number <- "R23"

day2_ibuttons <- rbind(day2_212,day2_control)
day2_ibuttons <- rbind(day2_ibuttons,day2_t3k)
day2_ibuttons <- rbind(day2_ibuttons,day2_t8f)
day2_ibuttons <- rbind(day2_ibuttons,day2_s02)
day2_ibuttons <- rbind(day2_ibuttons,day2_r23)

day2_ibuttons$Date <- dmy(02102014)

day3_220$iButton_Number <- "220"
day3_229k$iButton_Number <- "229K"
day3_b33$iButton_Number <- "B33"
day3_control$iButton_Number <- "S212"
day3_g16$iButton_Number <- "G16"
day3_r23$iButton_Number <- "R23"
day3_s02$iButton_Number <- "S02"
day3_t3k$iButton_Number <- "T3K"
day3_t48$iButton_Number <- "T48"
day3_t84$iButton_Number <- "T84"
day3_t8f$iButton_Number <- "T8F"

day3_ibuttons <- rbind(day3_220,day3_229k)
day3_ibuttons <- rbind(day3_ibuttons,day3_b33)
day3_ibuttons <- rbind(day3_ibuttons,day3_control)
day3_ibuttons <- rbind(day3_ibuttons,day3_g16)
day3_ibuttons <- rbind(day3_ibuttons,day3_r23)
day3_ibuttons <- rbind(day3_ibuttons,day3_s02)
day3_ibuttons <- rbind(day3_ibuttons,day3_t3k)
day3_ibuttons <- rbind(day3_ibuttons,day3_t48)
day3_ibuttons <- rbind(day3_ibuttons,day3_t84)
day3_ibuttons <- rbind(day3_ibuttons,day3_t8f)

day3_ibuttons$Date <- dmy(03102014)

tz(day1_ibuttons$Time) <- "Africa/Johannesburg"
tz(day2_ibuttons$Time) <- "Africa/Johannesburg"
tz(day3_ibuttons$Time) <- "Africa/Johannesburg"

day1_merge <- merge(day1_ibuttons,calibrationData,by=c("Date","iButton_Number"))
day1_begin <- min(day1_merge$Start_DateTime,na.rm=TRUE)
day1_end <- max(day1_merge$End_DateTime,na.rm=TRUE)
day1_int <- new_interval(day1_begin, day1_end)

day1_merge <- day1_merge[day1_merge$Time %within% day1_int,]


day2_merge <- merge(day2_ibuttons,calibrationData,by=c("Date","iButton_Number"))
day2_begin <- min(day2_merge$Start_DateTime,na.rm=TRUE)
day2_end <- max(day2_merge$End_DateTime,na.rm=TRUE)
day2_int <- new_interval(day2_begin, day2_end)
day2_merge <- day2_merge[day2_merge$Time %within% day2_int,]

day3_merge <- merge(day3_ibuttons,calibrationData,by=c("Date","iButton_Number"))
day3_begin <- min(day3_merge$Start_DateTime,na.rm=TRUE)
day3_end <- max(day3_merge$End_DateTime,na.rm=TRUE)
day3_int <- new_interval(day3_begin, day3_end)
day3_merge <- day3_merge[day3_merge$Time %within% day3_int,]

iButtonMerge_calibration <- rbind(day1_merge,day2_merge)
iButtonMerge_calibration <- rbind(iButtonMerge_calibration,day3_merge)

remove(list=c("day1_212","day1_control","day1_merge","day1_ibuttons","day1_r23","day1_s02","day1_t3k","day1_t8f","day2_212","day2_control","day2_ibuttons","day2_merge","day2_r23","day2_s02","day2_t3k","day2_t8f","day3_220","day3_229k","day3_b33","day3_control","day3_ibuttons","day3_g16","day3_merge","day3_r23","day3_s02","day3_t3k","day3_t48","day3_t84","day3_t8f"))

iButtonMerge_control <- subset(iButtonMerge_calibration,Trial_Number == "Control")
iButtonMerge_calibration <- subset(iButtonMerge_calibration,Trial_Number != "Control")

iButtonMerge_control$Trial_Number <- as.character(iButtonMerge_control$Trial_Number)

subTimeFxn <- function(dataf,calib_DF,TrialNumber_given){
  scratch <- subset(calib_DF,Trial_Number == TrialNumber_given)
#  interval_of_interest <- new_interval(scratch$Start_DateTime,scratch$End_DateTime-minutes(5))
  interval_of_interest <- new_interval(scratch$Start_DateTime,scratch$Start_DateTime+minutes(30))
  intermediate2 <- subset(dataf, Trial_Number == TrialNumber_given)
  intermediate <- intermediate2[intermediate2$Time %within% interval_of_interest,]
  return(intermediate)
}

dummyDF_to_fill <- data.frame("Trial_Number"= character(), "Time" = character(), "Temperature" = numeric())
colNamesToKeep = c("Trial_Number","Time","Temperature")

for(k in unique(calibrationData$Trial_Number)){
  subsetDF <- subTimeFxn(iButtonMerge_calibration,calib_DF = calibrationData,TrialNumber_given = k)
  
  interDF <- subsetDF[colNamesToKeep]
  interDF$Trial_Number <- as.character(interDF$Trial_Number)
  interDF$Time <- as.character(interDF$Time)
  dummyDF_to_fill <- rbind(dummyDF_to_fill,interDF)
}
#qplot(data = dummyDF_to_fill, x = Time, y = Temperature)+facet_wrap(~Trial_Number,scales = "free_x")

dummyDF_to_fill$Time <- ymd_hms(dummyDF_to_fill$Time)
tz(dummyDF_to_fill$Time) <- "Africa/Johannesburg"

tz(iButtonMerge_control$Time) <- "Africa/Johannesburg"
iButtonMerge_calibration <- merge(iButtonMerge_calibration,dummyDF_to_fill,all.y = TRUE)

# Now let's do it again for the iButton Controls

 subTimeFxn <- function(dataf,calib_DF,TrialNumber_given){
   scratch <- subset(calib_DF,Trial_Number == TrialNumber_given)
#   interval_of_interest <- new_interval(scratch$Start_DateTime,scratch$End_DateTime-minutes(5))

interval_of_interest <- new_interval(scratch$Start_DateTime,scratch$Start_DateTime+minutes(30))
   intermediate <- dataf[dataf$Time %within% interval_of_interest,]
   return(intermediate)
}
 
dummyDF_to_fill_control <- data.frame("Trial_Number"= character(),
                                      "Time" = character(),
                                      "Temperature" = numeric())

caliNotControl <- subset(calibrationData,Trial_Number != "Control")

 for(k in unique(caliNotControl$Trial_Number)){
   subsetDF <- subTimeFxn(iButtonMerge_control,calib_DF = caliNotControl,TrialNumber_given = k)
   interDF <- subsetDF[colNamesToKeep]

   
   if(nrow(interDF) > 0){
      interDF$Trial_Number <- k
      interDF$Time <- as.character(interDF$Time)
      dummyDF_to_fill_control <- rbind(dummyDF_to_fill_control,interDF)}
 }

toMerge <- ddply(dummyDF_to_fill_control,.(Trial_Number),summarize,meanControlTemp = mean(Temperature,na.omit=TRUE))

 iButtonMerge_calibration <- merge(iButtonMerge_calibration,
                                   toMerge,
                                   by = "Trial_Number",
                                   all.x = TRUE)
 
 iButtonMerge_calibration$Temperature = iButtonMerge_calibration$Temperature -  iButtonMerge_calibration$meanControlTemp
```

```{r thermocoupleMerge}
day1_thermo$Date <- dmy(1102014)
day3_thermo$Date <- dmy(3102014)

thermoMerge <- rbind(day1_thermo,day3_thermo)
tz(thermoMerge$Time) <- "Africa/Johannesburg"
#thermoMerge <- subset(thermoMerge,Temperature > 0 & Temperature < 2000)
thermoMerge <- subset(thermoMerge,Temperature > 0)

thermoMerge$Trial_Number <- 0
subTimeFxn <- function(dataf,calib_DF,TrialNumber_given){
  scratch <- subset(calib_DF,Trial_Number == TrialNumber_given)
  interval_of_interest <- new_interval(scratch$Start_DateTime,scratch$Next_Start_DateTime-minutes(1))
  intermediate <- dataf[dataf$Time %within% interval_of_interest,]
  return(intermediate)
}

dummyDF_to_fill <- data.frame("Trial_Number"= character(), "Time" = character(), "Temperature" = numeric())
colNamesToKeep = c("Trial_Number","Time","Temperature")

for(k in unique(calibrationData$Trial_Number)){
  if(k != "Control"){
  subsetDF <- subTimeFxn(thermoMerge,calib_DF = calibrationData,TrialNumber_given = k)}
  
  interDF <- subsetDF[colNamesToKeep]
  if(nrow(interDF) > 0){
    interDF$Trial_Number <- k
    interDF$Time <- as.character(interDF$Time)
    dummyDF_to_fill <- rbind(dummyDF_to_fill,interDF)
    }
  
}
#qplot(data=dummyDF_to_fill, x = Time, y = Temperature) + facet_wrap(~Trial_Number, scales = "free_x")

thermoMerge <- dummyDF_to_fill

thermoMerge$Time <- ymd_hms(thermoMerge$Time, tz="Africa/Johannesburg")

thermoMerge$Trial_Number <- as.factor(thermoMerge$Trial_Number)

```

# Load and Process Weather Data
```{r loadAndProcessWxData, echo=TRUE, results='hide',warning=FALSE}
wx1 <- read.csv("Data/Weather/X20140930A.csv",
                skip = 0)
wx2 <- read.csv("Data/Weather/X20141001A.csv")
wx3 <- read.csv("Data/Weather/X20141003A.csv")
wx4 <- read.csv("Data/Weather/X20141003A_2.csv")

wx1 <- wx1[-1,]
wx2 <- wx2[-1,]
wx3 <- wx3[-1,]        
wx4 <- wx4[-1,]

wx1$RH <- as.numeric(as.character(wx1$RH))
wx2$RH <- as.numeric(as.character(wx2$RH))
wx3$RH <- as.numeric(as.character(wx3$RH))
wx4$RH <- as.numeric(as.character(wx4$RH))

wx1$WS <- as.numeric(as.character(wx1$WS))
wx2$WS <- as.numeric(as.character(wx2$WS))
wx3$WS <- as.numeric(as.character(wx3$WS))
wx4$WS <- as.numeric(as.character(wx4$WS))

wx1$TP <- as.numeric(as.character(wx1$TP))
wx2$TP <- as.numeric(as.character(wx2$TP))
wx3$TP <- as.numeric(as.character(wx3$TP))
wx4$TP <- as.numeric(as.character(wx4$TP))

weatherAll <- rbind(wx1,wx2)
weatherAll <- rbind(weatherAll,wx3)
weatherAll <- rbind(weatherAll,wx4)


weatherAll$FORMATTED.DATE.TIME <- ymd_hms(weatherAll$FORMATTED.DATE.TIME, tz="Africa/Johannesburg")

weatherAll_subset <- subset(weatherAll, FORMATTED.DATE.TIME >= min(iButtonMerge_calibration$Time))

weatherAll_subset <- subset(weatherAll_subset, FORMATTED.DATE.TIME <= max(iButtonMerge_calibration$Time))


weatherAll_subset$Trial_Number <- 0
weatherAll_subset$Time <- weatherAll_subset$FORMATTED.DATE.TIME
#weatherAll_subset$FORMATTED.DATE.TIME <- NULL

subTimeFxn <- function(dataf,calib_DF,TrialNumber_given){
  scratch <- subset(calib_DF,Trial_Number == TrialNumber_given)
  interval_of_interest <- new_interval(scratch$Start_DateTime,
                                       scratch$Next_Start_DateTime - minutes(1))
  intermediate <- dataf[dataf$Time %within% interval_of_interest,]
  return(intermediate)
}

dummyDF_to_fill <- data.frame("Trial_Number"= character(),
                              "Time" = character(),
                              "WS" = numeric(),
                              "RH" = numeric(),
                              "TP" = numeric())

colNamesToKeep = c("Time","WS","RH","TP")

for(k in unique(calibrationData$Trial_Number)){
  if(k != "Control"){
  subsetDF <- subTimeFxn(weatherAll_subset,
                         calib_DF = calibrationData,
                         TrialNumber_given = k)}
  interDF <- subsetDF
  #interDF <- subsetDF[colNamesToKeep]
  
  if(nrow(interDF) > 0){
    
    interDF$Trial_Number <- k
    interDF$Time <- as.character(interDF$Time)
    dummyDF_to_fill <- rbind(dummyDF_to_fill,interDF)
    }
  
}

weatherAll_subset <- dummyDF_to_fill

weatherAll_subset$DT <- as.numeric(as.character(weatherAll_subset$WS))
weatherAll_subset$TP <- as.numeric(as.character(weatherAll_subset$TP))
weatherAll_subset$RH <- as.numeric(as.character(weatherAll_subset$RH))
weatherAll_subset$WS <- as.numeric(as.character(weatherAll_subset$WS))

weatherAll_subset$Trial_Number <- as.factor(weatherAll_subset$Trial_Number)

weatherAggregate <- ddply(.data = weatherAll_subset,
                          .variables = .(Trial_Number),
                          .fun = summarise,
                          RH_mean = mean(RH, na.rm = TRUE),
                          RH_min = min(RH, na.rm = TRUE),
                          RH_max = max(RH, na.rm = TRUE),
                          WS_mean = mean(WS, na.rm = TRUE),
                          WS_min = min(WS, na.rm = TRUE),
                          WS_max = max(WS, na.rm = TRUE),
                          TP_mean = mean(TP, na.rm = TRUE))

calibrationData <- merge(calibrationData,weatherAggregate,by = "Trial_Number",all.x = TRUE)

remove(list=c("weatherAll","weatherAll_subset","wx1","wx2","wx3","wx4"))
```
# Process and merge data
```{r moreProcessing,echo=TRUE,warning=FALSE}

#downSampled <- merge(iButtonMerge_calibration,thermoMerge,by="Trial_Number")
#names(downSampled)[2] <- "Time"
#names(downSampled)[3] <- "iButtonTemperature"
#downSampled$Time.y <- NULL
#names(downSampled)[18] <- "thermoTemperature"



downSampled_iButton <- ddply(iButtonMerge_calibration,
              .(Trial_Number),
              summarize,
              maxTemp_i = max(Temperature),
              sumTemp_i = sum(Temperature),
              rangeTemp_i = max(Temperature) - min(Temperature)
              )


downSampled_thermo <- ddply(thermoMerge,
              .(Trial_Number),
              summarize,
              maxTemp_t = max(Temperature),
              sumTemp_t = sum(Temperature),
              rangeTemp_t = max(Temperature) - min(Temperature))


downSampled_thermo <- subset(downSampled_thermo,Trial_Number != "Control")

maxSub_i <- max_subset(dframe = iButtonMerge_calibration,tempvar = iButtonMerge_calibration$Temperature,time = iButtonMerge_calibration$Time,PlotID = iButtonMerge_calibration$Trial_Number)


maxSub_sub_i<- ddply(maxSub_i,
              .(PlotID),
              summarize,
              maxTemp_subset_iButton = max(Temp),
              rangeTemp_subset_iButton = max(Temp) - min(Temp),
              sumTemp_subset_iButton = sum(Temp))

maxSub_sub_i <- subset(maxSub_sub_i,PlotID != "Control")

names(maxSub_sub_i) <- c("PlotID","maxTemp_subset_iButton","rangeTemp_subset_iButton","sumTemp_subset_iButton")

downSampled_sub <- merge(downSampled_iButton,downSampled_thermo,by="Trial_Number",all.x = TRUE)

maxSub_sub <- merge(maxSub_sub_i,downSampled_sub,by.x="PlotID",by.y="Trial_Number")
#maxSub_sub <- merge(maxSub_sub_t,maxSub_sub,by="PlotID")

#maxSub_sub$maxTemp.y <- NULL
#maxSub_sub$rangeTemp.y <- NULL

#names(maxSub_sub) <- c("Trial_Number","maxTemp","rangeTemp","sumTempPeak","sumTempAll","Intensity")
IntensityCalcs <- calibrationData

PlotSize <- 1/4
HeatYield <- 16890 / 100
RateOfSpread <- PlotSize / (IntensityCalcs$FlameTime_seconds + IntensityCalcs$SmoulderingTime_seconds)
GramsConsumed <- IntensityCalcs$FuelLoad_g / PlotSize^2

IntensityCalcs$Intensity <- HeatYield * GramsConsumed * RateOfSpread

reMergeAnalysis <- merge(maxSub_sub,IntensityCalcs,by.x="PlotID",by.y="Trial_Number")

#reMergeAnalysis$Intensity2 <- 2729 + 0.8684 * reMergeAnalysis$FuelLoad_g - 530 * sqrt(11) - 0.907 * reMergeAnalysis$RH_mean^2 - 569 * 1/reMergeAnalysis$WS_mean

```
# Exploratory Visualizations

## Fuel Loading Effects

```{r FuelLoadPlots, echo = FALSE, warning=FALSE}

basicPlot <- ggplot(data = reMergeAnalysis)+
  myTheme


basicPlot+ 
  xlab("Fuel Load (g)")+
  ylab("Flaming Time (s)")+
  geom_point(aes(x = FuelLoad_g, y = FlameTime_seconds))+
  geom_smooth(method="lm",aes(x = FuelLoad_g, y = FlameTime_seconds))

basicPlot+
  xlab("Fuel Load (g)")+
  ylab("Smoldering Time (s)")+
  geom_point(aes(x = FuelLoad_g, y = SmoulderingTime_seconds))+
  geom_smooth(method="lm",aes(x = FuelLoad_g, y = SmoulderingTime_seconds))

basicPlot+
  xlab("Fuel Load (g)")+
  ylab("Total Combustion Time (s)")+
  geom_point(aes(x = FuelLoad_g, y = (FlameTime_seconds + SmoulderingTime_seconds)))+
  geom_smooth(method="lm",aes(x = FuelLoad_g, y = (FlameTime_seconds + SmoulderingTime_seconds)))



basicPlot+
  xlab("Fuel Load (g)")+
  ylab("Summed Temperature up to the Peak")+
  geom_point(aes(x = FuelLoad_g, y = sumTemp_subset_iButton))+
  geom_smooth(method="lm",aes(x = FuelLoad_g, y = sumTemp_subset_iButton))

basicPlot+
  xlab("Fuel Load (g)")+
  ylab("Max Temp Thermocouple")+
  geom_point(aes(x = FuelLoad_g, y = maxTemp_t))+
  geom_smooth(method="lm",aes(x = FuelLoad_g, y = maxTemp_t))

basicPlot+
  xlab("Fuel Load (g)")+
  ylab("Sum Temp Thermocouple")+
  geom_point(aes(x = FuelLoad_g, y = sumTemp_t))+
  geom_smooth(method="lm",aes(x = FuelLoad_g, y = sumTemp_t))

basicPlot+
  xlab("Fuel Load (g)")+
  ylab("Max Temp")+
  geom_point(aes(x = FuelLoad_g, y = maxTemp_subset_iButton))+
  geom_smooth(method="lm",aes(x = FuelLoad_g, y = maxTemp_subset_iButton))


basicPlot+
  xlab("Fuel Load (g)")+
  ylab("Total Combustion Time (s)")+
  geom_point(aes(x = FuelLoad_g, y = (FlameTime_seconds + SmoulderingTime_seconds)))+
  geom_smooth(method="lm",aes(x = FuelLoad_g, y = (FlameTime_seconds + SmoulderingTime_seconds)))
```

## Relationships with Byram's Intensity

```{r IntensityPlots, echo = FALSE, warning=FALSE}
basicPlot <- ggplot(data = reMergeAnalysis)+
  myTheme


basicPlot+
  xlab("Fuel Load (g)")+
  ylab("Byram's Fireline Intensity")+
  geom_point(aes(x = FuelLoad_g, y = (Intensity)))+
  geom_smooth(method="lm",aes(x = FuelLoad_g, y = (Intensity)))


basicPlot+
  xlab("Smoldering Time (s)")+
  ylab("Byram's Fireline Intensity")+
  geom_point(aes(x = SmoulderingTime_seconds, y = Intensity))+
  geom_smooth(method="lm",aes(x = SmoulderingTime_seconds, y = Intensity))


basicPlot+
  xlab("Max Temperature")+
  ylab("Byram's Fireline Intensity")+
  geom_point(aes(x = maxTemp_subset_iButton, y = Intensity))+
  geom_smooth(method="lm",aes(x = maxTemp_subset_iButton, y = Intensity))

basicPlot+
  xlab("Summed Temperature up to the Peak")+
  ylab("Byram's Fireline Intensity")+
  geom_point(aes(x = sumTemp_subset_iButton, y = Intensity))+
  geom_smooth(method="lm",aes(x = sumTemp_subset_iButton, y = Intensity))


basicPlot+
  xlab("Summed Temperature During Combustion")+
  ylab("Byram's Fireline Intensity")+
  geom_point(aes(x = sumTemp_i, y = Intensity))+
  geom_smooth(method="lm",aes(x = sumTemp_i, y = Intensity))

basicPlot+
  xlab("Total Combustion Time (s)")+
  ylab("Byram's Fireline Intensity")+
  geom_point(aes(x = (FlameTime_seconds + SmoulderingTime_seconds), y = Intensity))+
  geom_smooth(method="lm",aes(x = (FlameTime_seconds + SmoulderingTime_seconds), y = Intensity))


basicPlot+
  xlab("Temperature Range")+
  ylab("Byram's Fireline Intensity")+
  geom_point(aes(x = rangeTemp_subset_iButton, y = Intensity))+
  geom_smooth(method="lm",aes(x = rangeTemp_subset_iButton, y = Intensity))
```

## Relationships with Weather Variables

```{r WeatherPlots, echo = FALSE, warning=FALSE}
basicPlot <- ggplot(data = reMergeAnalysis)+
  myTheme

basicPlot+
  ylab("Summed Temperature Anomaly")+
  xlab("Mean RH")+
  geom_point(aes(x = RH_mean, y = sumTemp_i))+
  geom_smooth(method="lm",aes(x = RH_mean, y = sumTemp_i))

basicPlot+
  ylab("Max Temperature Anomaly")+
  xlab("Mean RH")+
  geom_point(aes(x = RH_mean, y = maxTemp_i))+
  geom_smooth(method="lm",aes(x = RH_mean, y = maxTemp_i))

basicPlot+
  ylab("Summed Temperature Anomaly")+
  xlab("Mean WS")+
  geom_point(aes(x = WS_mean, y = sumTemp_i))+
  geom_smooth(method="lm",aes(x = WS_mean, y = sumTemp_i))

basicPlot+
  ylab("Max Temperature Anomaly")+
  xlab("Mean WS")+
  geom_point(aes(x = WS_mean, y = maxTemp_i))+
  geom_smooth(method="lm",aes(x = WS_mean, y = maxTemp_i))


basicPlot+
  xlab("Mean WS")+
  ylab("Byram's Fireline Intensity")+
  geom_point(aes(x = WS_mean, y = Intensity))+
  geom_smooth(method="lm",aes(x = WS_mean, y = Intensity))

basicPlot+
  xlab("Max WS")+
  ylab("Byram's Fireline Intensity")+
  geom_point(aes(x = WS_max, y = Intensity))+
  geom_smooth(method="lm",aes(x = WS_max, y = Intensity))

basicPlot+
  xlab("Max WS")+
  ylab("Summed Temperature up to the Peak")+
  geom_point(aes(x = WS_max, y = sumTemp_subset_iButton))+
  geom_smooth(method="lm",aes(x = WS_max, y = sumTemp_subset_iButton))

basicPlot+
  xlab("Min RH")+
  ylab("Byram's Fireline Intensity")+
  geom_point(aes(x = RH_min, y = Intensity))+
  geom_smooth(method="lm",aes(x = RH_min, y = Intensity))

basicPlot+
  xlab("Mean RH")+
  ylab("Summed Temperature During Combustion")+
  geom_point(aes(x = RH_mean, y = sumTemp_i))+
  geom_smooth(method="lm",aes(x = RH_mean, y = sumTemp_i))


basicPlot+
  xlab("Min RH")+
  ylab("Summed Temperature During Combustion")+
  geom_point(aes(x = RH_min, y = sumTemp_i))+
  geom_smooth(method="lm",aes(x = RH_min, y = sumTemp_i))


basicPlot+
  xlab("Mean RH")+
  ylab("Summed Temperature up to the Peak")+
  geom_point(aes(x = RH_mean, y = sumTemp_subset_iButton))+
  geom_smooth(method="lm",aes(x = RH_mean, y = sumTemp_subset_iButton))

basicPlot+
  xlab("Mean WS (m/s)")+
  ylab("Combustion Time (s)")+
  geom_point(aes(x = WS_mean, y = (FlameTime_seconds + SmoulderingTime_seconds)))+
  geom_smooth(method="lm",aes(x = WS_mean, y = (FlameTime_seconds + SmoulderingTime_seconds)))
```

## Relationships between iButton and Thermocouple

```{r iButtonThermoPlots, echo = FALSE, warning=FALSE}
basicPlot <- ggplot(data = reMergeAnalysis)+
  myTheme


basicPlot+
  xlab("iButton Temp Anomaly")+
  ylab("Thermocouple Max Temperature Observed")+
  geom_point(aes(x = maxTemp_i, size = FuelLoad_g, y = (maxTemp_t)))+
 #  geom_text(aes(x = maxTemp_subset_iButton, y = maxTemp_t, label = PlotID))
 
  geom_smooth(method="lm",aes(x = maxTemp_i, y = (maxTemp_t)))


basicPlot+
  xlab("Sum Temp Peak iButton")+
  ylab("Thermocouple Max Temperature Observed")+
#  geom_text(aes(x = sumTemp_subset_iButton, y = maxTemp_t, label = PlotID))+
  geom_point(aes(x = sumTemp_subset_iButton, y = maxTemp_t))+
  geom_smooth(method="lm",aes(x = sumTemp_subset_iButton, y = maxTemp_t))


basicPlot+
  xlab("Temperature Range")+
  ylab("Thermocouple Max Temperature Observed")+
  geom_point(aes(x = rangeTemp_subset_iButton, y = maxTemp_t))+
  geom_smooth(method="lm",aes(x = rangeTemp_subset_iButton, y = maxTemp_t))

basicPlot+
  xlab("maxTemp iButton Peak")+
  ylab("Thermocouple Sum Temperature Observed")+
  geom_point(aes(x = maxTemp_subset_iButton, y = sumTemp_t))+
  geom_smooth(method="lm",aes(x = maxTemp_subset_iButton, y = sumTemp_t))

basicPlot+
  xlab("sumTemp iButton Peak")+
  ylab("Thermocouple Sum Temperature Observed")+
#  geom_point(aes(x = sumTemp_subset_iButton, y = sumTemp_t))+
  geom_text(aes(x = sumTemp_subset_iButton, y = sumTemp_t, label = PlotID))
  geom_smooth(method="lm",aes(x = sumTemp_subset_iButton, y = sumTemp_t))

```

## iButton Residual ~ Weather Analysis

Calculate residuals of lm
```{r calculateResiduals}
testResidsDF_i <- reMergeAnalysis
testResidsDF_tc <- subset(reMergeAnalysis, !is.na(maxTemp_t))

testResidsDF_i$iButton_resids <- residuals(maxTemp_by_FuelLoad_iButton)
testResidsDF_tc$thermocouple_resids <- residuals(maxTemp_by_FuelLoad_thermocouple)
```

## Thermocouple Residual ~ Weather Analysis

```{r TCplotPrepare, echo=FALSE}
basicPlotTC <- ggplot(data = testResidsDF_tc)+
  myTheme+
  ylab("TC Residuals")
```
  
```{r echo=FALSE}
basicPlotTC+
  xlab("Mean RH")+
  geom_point(aes(x = RH_mean, y = thermocouple_resids))+
  geom_smooth(method="lm",aes(x = RH_mean, y = thermocouple_resids))
```

```{r thermoCouple}
TCresids_by_RHmean <- lm(thermocouple_resids ~ RH_mean, testResidsDF_tc)
summary(TCresids_by_RHmean)
```

```{r echo=FALSE}
basicPlotTC+
  xlab("Mean WS")+
  geom_point(aes(x = WS_mean, y = thermocouple_resids))+
  geom_smooth(method="lm",aes(x = WS_mean, y = thermocouple_resids))
```

```{r}
TCresids_by_WSmean <- lm(thermocouple_resids ~ WS_mean, testResidsDF_tc)
summary(TCresids_by_WSmean)
```

```{r echo=FALSE}
basicPlotTC+
  xlab("Max WS")+
  geom_point(aes(x = WS_max, y = thermocouple_resids))+
  geom_smooth(method="lm",aes(x = WS_max, y = thermocouple_resids))
```

```{r}
TCresids_by_WSmax <- lm(thermocouple_resids ~ WS_max, testResidsDF_tc)
summary(TCresids_by_WSmax)
```

```{r echo=FALSE}
basicPlotTC+
  xlab("RH min")+
  geom_point(aes(x = RH_min, y = thermocouple_resids))+
  geom_smooth(method="lm",aes(x = RH_min, y = thermocouple_resids))

```

```{r}
TCresids_by_RHmin <- lm(thermocouple_resids ~ RH_min, testResidsDF_tc)
summary(TCresids_by_RHmin)
```

## Plot thermocouple residuals

```{r iButtonplotPrepare, echo=FALSE}
basicPlotI <- ggplot(data = testResidsDF_i)+
  myTheme+
  ylab("iButton Residuals")
```
  
```{r echo=FALSE}
basicPlotI+
  xlab("Mean RH")+
  geom_point(aes(x = RH_mean, y = iButton_resids))+
  geom_smooth(method="lm",aes(x = RH_mean, y = iButton_resids))
```

```{r}
IBresids_by_RHmean <- lm(iButton_resids ~ RH_mean, testResidsDF_i)
summary(IBresids_by_RHmean)
```

```{r echo=FALSE}
basicPlotI+
  xlab("Mean WS")+
  geom_point(aes(x = WS_mean, y = iButton_resids))+
  geom_smooth(method="lm",aes(x = WS_mean, y = iButton_resids))
```

```{r}
IBresids_by_WSmean <- lm(iButton_resids ~ WS_mean, testResidsDF_i)
summary(IBresids_by_WSmean)
```

```{r echo=FALSE}
basicPlotI+
  xlab("Max WS")+
  geom_point(aes(x = WS_max, y = iButton_resids))+
  geom_smooth(method="lm",aes(x = WS_max, y = iButton_resids))
```

```{r}
IBresids_by_WSmax <- lm(iButton_resids ~ WS_max, testResidsDF_i)
summary(IBresids_by_WSmax)
```

```{r echo=FALSE}
basicPlotI+
  xlab("RH min")+
  geom_point(aes(x = RH_min, y = iButton_resids))+
  geom_smooth(method="lm",aes(x = RH_min, y = iButton_resids))

```

```{r}
IBresids_by_RHmin <- lm(iButton_resids ~ RH_min, testResidsDF_i)
summary(IBresids_by_RHmin)
```

# Figures for Analysis

## Figure 1

```{r Figure1, echo = FALSE, warning=FALSE, dpi=600, fig.ext='tiff',fig.width=3,fig.height=3}
Trial_to_subset <- 51

justOne <- subset(maxSub_i,PlotID == Trial_to_subset)
names(justOne) <- c("Trial_Number","Time","Temperature")

justOne_full <- subset(iButtonMerge_calibration,Trial_Number == Trial_to_subset)
justOne_full_sub <- justOne_full[c("Time","Temperature","Trial_Number")]

justOne_thermo <- subset(thermoMerge,Trial_Number == Trial_to_subset)
justOne_thermo <- subset(justOne_thermo, Time %within% interval(min(justOne_full$Time),max(justOne_full$Time)))

justOne_full_sub$Type <- "Complete iButton"
justOne_thermo$Type <- "Thermocouple"
justOne$Type <- "Partial iButton"

intermediate <- rbind(justOne_full_sub,justOne_thermo)
intermediate <- rbind(intermediate,justOne)

final <- ddply(intermediate,.(Type),mutate,Seconds = Time - min(Time))






design <- readPNG("Images/design.png")
b <- rasterGrob(design, interpolate=TRUE)

fig1_plotA <- qplot(1:10, 1:10, geom="blank") +
  ggtitle("A.")+
  myTheme+
     theme(plot.title = element_text(size=12,
                                  hjust="0",
                                  face="plain"),
           panel.grid.minor.y=element_blank(),
           panel.grid.major.y=element_blank(),
           axis.ticks = element_blank(),
           axis.line = element_blank(),
           axis.text  = element_blank(),
         legend.position=c(.8,.9),legend.direction="vertical")+
  xlab("")+
  ylab("")+
  annotation_custom(b, xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf)


plotPicture <- readPNG("Images/example.png")
g <- rasterGrob(plotPicture, interpolate=TRUE)

fig1_plotB <- qplot(1:10, 1:10, geom="blank") +
  ggtitle("B.")+
  myTheme+
     theme(plot.title = element_text(size=12,
                                  hjust="0",
                                  face="plain"),
           panel.grid.minor.y=element_blank(),
           panel.grid.major.y=element_blank(),
           axis.ticks = element_blank(),
           axis.line = element_blank(),
           axis.text  = element_blank(),
         legend.position=c(.8,.9),legend.direction="vertical")+
  xlab("")+
  ylab("")+
  annotation_custom(g, xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf)

fig1_plotC <- ggplot(data = final, aes(x = as.numeric(Seconds), y= log(Temperature), colour = Type))+
  ggtitle("C.")+
  myTheme+
     theme(plot.title = element_text(size=10,
                                  hjust="0",
                                  face="plain"),
          #legend.position=c(.8,.9),
           legend.position="none",
           legend.direction="vertical",
           legend.text = element_text(size = 4))+
  xlab("Time (s)")+
  guides(fill = guide_legend(keywidth = 1, keyheight = 1))+
  ylab("log Temperature (C)")+
  scale_colour_manual(name  = "",
                      values=c("Partial iButton"="red","Complete iButton"="black","Thermocouple"="blue"))+
  scale_x_continuous(breaks = c(0, 1000, 2000))+
  geom_line()



Fig1 <- grid.arrange(fig1_plotA,fig1_plotB,fig1_plotC,nrow=2,ncol=2)

Fig1
```

## Figure 2

```{r Figure2_CompareBiomass, echo=FALSE, warning=FALSE, dpi=600, fig.ext='tiff',fig.width=6,fig.height=4}
imax_lab <- expression(paste(I[Max], " (", degree, "C)", sep=""))
tmax_lab <- expression(paste(T[Max], " (", degree, "C)", sep=""))
isum_lab <- expression(paste(I[Sum], " (", degree, "C)", sep=""))
tsum_lab <- expression(paste(T[Sum], " (", degree, "C)", sep=""))
fuelload_lab <- "Biomass Combusted (g)"
intensity_lab <- expression(paste("Fire Intensity (kW ","m",{}^{-1},")"))

scientific_10 <- function(x) {
  parse(text=gsub("e", " %*% 10^", scientific_format()(x)))
}

fig3_plotA<- ggplot(data = reMergeAnalysis)+
  ggtitle("A.")+
  myTheme+
     theme(plot.title = element_text(size=12,
                                  hjust="0",
                                  family = "Arial",
                                  face="plain"),
         legend.position=c(.8,.9),legend.direction="vertical")+
   ylab(imax_lab)+
  xlab(fuelload_lab)+
  ylim(0,40)+
  geom_point(aes(x = FuelLoad_g, y =  maxTemp_i))+
  geom_smooth(method="lm",aes(x = FuelLoad_g, y =  maxTemp_i),se=FALSE)

fig3_plotB <- ggplot(data = reMergeAnalysis)+
  ggtitle("B.")+
  myTheme+
     theme(plot.title = element_text(size=12,
                                  hjust="0",
                                  family = "Arial",
                                  face="plain"),
         legend.position=c(.8,.9),legend.direction="vertical")+
  xlab(fuelload_lab)+
  ylab(tmax_lab)+
  ylim(0,1200)+
  geom_point(aes(x = FuelLoad_g, y = maxTemp_t))+
  geom_smooth(method="lm",aes(x = FuelLoad_g, y = maxTemp_t),se=FALSE)


fig3_plotC <- ggplot(data = reMergeAnalysis)+
  ggtitle("C.")+
  myTheme+
     theme(plot.title = element_text(size=12,
                                  hjust="0",
                                  family = "Arial",
                                  face="plain"),
         legend.position=c(.8,.9),legend.direction="vertical")+
  ylab(intensity_lab)+
  xlab(tsum_lab)+
  scale_y_continuous(limits=c(0,3000))+
   scale_x_continuous(breaks=c(0,25000,50000,75000,100000))+
  geom_point(aes(x = sumTemp_t, y = Intensity))+
  geom_smooth(method="lm",aes(x = sumTemp_t, y = Intensity),se=FALSE)



fig3_plotD <- ggplot(data = reMergeAnalysis)+
  ggtitle("D.")+
  myTheme+
     theme(plot.title = element_text(size=12,
                                  hjust="0",
                                  family = "Arial",
                                  face="plain"),
         legend.position=c(.8,.9),legend.direction="vertical")+
  xlab(fuelload_lab)+
  ylab(isum_lab)+
  scale_y_continuous(limits=c(0,2500))+
  geom_point(aes(x = FuelLoad_g, y = sumTemp_subset_iButton))+
  geom_smooth(method="lm",aes(x = FuelLoad_g, y = sumTemp_subset_iButton),se=FALSE)

fig3_plotE <- ggplot(data = reMergeAnalysis)+
  ggtitle("E.")+
  myTheme+
     theme(plot.title = element_text(size=12,
                                  hjust="0",
                                  family = "Arial",
                                  face="plain"),
         legend.position=c(.8,.9),legend.direction="vertical")+
  xlab(fuelload_lab)+
  ylab(tsum_lab)+
  scale_y_continuous(limits=c(0,100000))+
  geom_point(aes(x = FuelLoad_g, y = sumTemp_t))+
  geom_smooth(method="lm",aes(x = FuelLoad_g, y = sumTemp_t),se=FALSE)

fig3_plotF <- ggplot(data = reMergeAnalysis)+
  ggtitle("F.")+
  myTheme+
     theme(plot.title = element_text(size=12,
                                  hjust="0",
                                  family = "Arial",
                                  face="plain"),
         legend.position=c(.8,.9),legend.direction="vertical")+
  ylab(intensity_lab)+
  xlab(tsum_lab)+
  scale_x_continuous()+
  scale_y_continuous(limits=c(0,3000))+
  geom_point(aes(x = sumTemp_i, y = Intensity))+
  geom_smooth(method="lm",aes(x = sumTemp_i, y = Intensity),se=FALSE)


grid.arrange(nrow=2,fig3_plotA,fig3_plotB,fig3_plotC,fig3_plotD,fig3_plotE,fig3_plotF)

```

# Modelled Relationships

```{r Models}
#reMergeAnalysis$Duration <- reMergeAnalysis$FlameTime_seconds + reMergeAnalysis$SmoulderingTime_seconds

maxTemp_by_FuelLoad_iButton <- lm(maxTemp_subset_iButton ~ FuelLoad_g,data=reMergeAnalysis)
maxTemp_by_FuelLoad_thermocouple <- lm(maxTemp_t ~ FuelLoad_g,data=reMergeAnalysis)

a <- reMergeAnalysis[c("maxTemp_subset_iButton","maxTemp_t","FuelLoad_g")]
b <- melt(a,measure.vars = c("maxTemp_subset_iButton","maxTemp_t"))
names(b) <- c("FuelLoad_g","Method","Temperature")

c <- subset(b, Method == "maxTemp_subset_iButton")
d <- subset(b, Method == "maxTemp_t")


maxTemp_by_FuelLoad_iButton <- lm(Temperature ~ FuelLoad_g,data=c)
maxTemp_by_FuelLoad_thermocouple <- lm(Temperature ~ FuelLoad_g,data=d)
compareMethod <- lm(Temperature ~ FuelLoad_g + Method,data=b)

AIC(maxTemp_by_FuelLoad_iButton,maxTemp_by_FuelLoad_thermocouple)
anova(compareMethod)

#maxTemp_by_iMaxXDuration <- lm(maxTemp_t ~ maxTemp_subset_iButton * WS_max,data=reMergeAnalysis)

sumTempPeak_by_FuelLoad <- lm(sumTemp_subset_iButton ~ FuelLoad_g, data=reMergeAnalysis)
sumTemp_by_FuelLoad_thermocouple <- lm(sumTemp_t ~ FuelLoad_g,data=reMergeAnalysis)


sumTemp_by_FuelLoad <- lm(sumTemp_i ~ FuelLoad_g, data=reMergeAnalysis)

Intensity_by_FuelLoad <- lm(Intensity ~ FuelLoad_g,data=reMergeAnalysis)
Intensity_by_iMax <- lm(Intensity ~ maxTemp_subset_iButton,data=reMergeAnalysis)
Intensity_by_sumTempPeak <- lm(Intensity ~ sumTemp_subset_iButton,data=reMergeAnalysis)
Intensity_by_sumTemp <- lm(Intensity ~ sumTemp_t,data=reMergeAnalysis)

maxTemp_by_maxTemp_subset_i <- lm(maxTemp_t ~ maxTemp_subset_iButton,data=reMergeAnalysis)
maxTemp_by_maxTemp_i <- lm(maxTemp_t ~ maxTemp_i,data=reMergeAnalysis)
maxTemp_by_maxTemp_i_x_sumTemp <- lm(maxTemp_t ~ maxTemp_i * sumTemp_subset_iButton,data=reMergeAnalysis)
maxTemp_bysumTempPeak <- lm(maxTemp_t ~ sumTemp_subset_iButton,data=reMergeAnalysis)
maxTemp_bysumTemp <- lm(maxTemp_t ~ sumTemp_i,data=reMergeAnalysis)

```


```{r Model_Summaries1,echo=FALSE,results='asis'}
htmlreg(l=list(maxTemp_by_FuelLoad_iButton), doctype = F, html.tag = TRUE, star.symbol="\\*", inline.css = TRUE, head.tag = FALSE, body.tag = FALSE, center = FALSE, single.row = TRUE, caption = "maxTemp ~ FuelLoad_g", custom.model.names = "Imax ~ FuelLoad_g")

htmlreg(l=list(maxTemp_by_FuelLoad_thermocouple), doctype = F, html.tag = TRUE, star.symbol="\\*", inline.css = TRUE, head.tag = FALSE, body.tag = FALSE, center = FALSE, single.row = TRUE, caption = "maxTemp ~ FuelLoad_g", custom.model.names = "Tmax ~ FuelLoad_g")

htmlreg(l=list(sumTempPeak_by_FuelLoad), doctype = F, html.tag = TRUE, star.symbol="\\*", inline.css = TRUE, head.tag = FALSE, body.tag = FALSE, center = FALSE, single.row = TRUE, caption = "", custom.model.names=c("Isum-peak ~ FuelLoad_g")) 

htmlreg(l=list(sumTemp_by_FuelLoad), doctype = F, html.tag = TRUE, inline.css = TRUE, head.tag = FALSE, body.tag = FALSE, center = FALSE, single.row = TRUE, caption = "", star.symbol="\\*", custom.model.names=c("Isum ~ FuelLoad_g")) 

```


```{r Model_Summaries2,echo=FALSE,results='asis'}
htmlreg(l=list(Intensity_by_sumTempPeak), doctype = F, star.symbol = "\\*", html.tag = FALSE, inline.css = TRUE, head.tag = FALSE, body.tag = FALSE, center = FALSE, single.row = TRUE, caption = "", custom.model.names=c("Intensity ~ Isum(peak)")) 

htmlreg(l=list(Intensity_by_sumTemp), doctype = F, star.symbol = "\\*", html.tag = FALSE, inline.css = TRUE, head.tag = FALSE, body.tag = FALSE, center = FALSE, single.row = TRUE, caption = "", custom.model.names=c("Intensity ~ Isum")) 
```

```{r Model_Summaries3,echo=FALSE,results='asis'}
htmlreg(l=list(maxTemp_by_maxTemp_subset_i), doctype = F, html.tag = FALSE, inline.css = TRUE,     head.tag = FALSE, body.tag = FALSE, center = FALSE, single.row = TRUE, star.symbol="\\*", caption = "", custom.model = ("Tmax ~ Imax"))

htmlreg(l=list(maxTemp_bysumTempPeak), doctype = F, html.tag = FALSE, star.symbol="\\*", inline.css = TRUE, 
    head.tag = FALSE, body.tag = FALSE, center = FALSE, single.row = TRUE, caption = "", custom.model.names=c("Tmax ~ Isum(peak)"))

htmlreg(l=list(maxTemp_bysumTemp), doctype = F, html.tag = FALSE, star.symbol="\\*", inline.css = TRUE, 
    head.tag = FALSE, body.tag = FALSE, center = FALSE, single.row = TRUE, caption = "", custom.model.names=c("Tsum ~ Isum"))


```


